import Layout from "@/components/Layout";
import RecommendationCard from "@/components/card/RecommendationCard";
import { listMobil } from "@/data/data";
import { Box, Container, Grid, Link, Typography } from "@mui/material";
import Head from "next/head";
import { useRouter } from "next/router";
import React from "react";

type Props = {};

const SearchResult = (props: Props) => {
  const router = useRouter();
  const searchQuery = router.query.search;

  const query = Array.isArray(searchQuery) ? searchQuery[0] : searchQuery;

  let filteredResults: ListItem[] = [];

  if (typeof query === "string") {
    filteredResults = listMobil.filter((item) =>
      item.namaMobil.toLowerCase().includes(query.toLowerCase())
    );
  }

  return (
    <Layout>
      <Head>
        <title>Beli Mobil Bekas terbaik di Batam</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Box
        sx={{
          paddingY: filteredResults.length > 3 ? "6rem" : "0",
          minHeight: "100vh",
          display: 'flex',
          placeContent: 'center',
          alignItems: 'center'
        }}
      >
        <Container>
          {filteredResults.length > 0 ? (
            <>
              <Typography variant="h5" component={"h2"}>
                Hasil Pencarian untuk{" "}
                <Typography variant="h5" component="span" color={"blue"}>
                  {searchQuery}
                </Typography>
              </Typography>
              <Typography variant="body1" component={"p"}>
                Menampilkan <Typography variant="body1" component="span" color={"blue"}>{filteredResults.length}</Typography> hasil
              </Typography>
              <Grid container>
                {filteredResults.map((item, index) => (
                  <Grid key={index} item xs={6} md={4}>
                    <Link
                      href={`/mobilbekas/${item.namaMobil}`}
                      underline="none"
                    >
                      <RecommendationCard
                        key={index}
                        image={item.gambar}
                        location={item.lokasi}
                        merk={item.namaMobil}
                        price={item.harga}
                      />
                    </Link>
                  </Grid>
                ))}
              </Grid>
            </>
          ) : (
            <Box sx={{marginY: "15rem"}}>
              <Typography variant="h4" component={"h2"} textAlign={"center"}>
                Maaf, tidak ada hasil untuk pencarian{" "}
                <Typography variant="h4" component="span" color={"blue"}>
                  {searchQuery}
                </Typography>
              </Typography>
            </Box>
          )}
        </Container>
      </Box>
    </Layout>
  );
};

export default SearchResult;
